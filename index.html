
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link href="images/favicon-f3a55fd3.ico" rel="icon" type="image/ico" />
        <meta
            name="description"
            content="Documentation for 인공지능융합연구센터"
        >
    <title>API Reference</title>

    <style media="screen">
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .ch, .highlight .cd, .highlight .cpf {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s, .highlight .sa, .highlight .dl {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf, .highlight .fm {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
}
.highlight .nn {
  color: #ffffff;
}
.highlight .ni {
  color: #ffffff;
}
.highlight .bp {
  color: #ffffff;
}
.highlight .vg {
  color: #ffffff;
}
.highlight .vi {
  color: #ffffff;
}
.highlight .nv, .highlight .vm {
  color: #ffffff;
}
.highlight .w {
  color: #ffffff;
}
.highlight {
  color: #ffffff;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
}
.highlight .nl {
  color: #f92672;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
    </style>
    <style media="print">
      * {
        -webkit-transition:none!important;
        transition:none!important;
      }
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight, .highlight .w {
  color: #586e75;
}
.highlight .err {
  color: #002b36;
  background-color: #dc322f;
}
.highlight .c, .highlight .ch, .highlight .cd, .highlight .cm, .highlight .cpf, .highlight .c1, .highlight .cs {
  color: #657b83;
}
.highlight .cp {
  color: #b58900;
}
.highlight .nt {
  color: #b58900;
}
.highlight .o, .highlight .ow {
  color: #93a1a1;
}
.highlight .p, .highlight .pi {
  color: #93a1a1;
}
.highlight .gi {
  color: #859900;
}
.highlight .gd {
  color: #dc322f;
}
.highlight .gh {
  color: #268bd2;
  background-color: #002b36;
  font-weight: bold;
}
.highlight .k, .highlight .kn, .highlight .kp, .highlight .kr, .highlight .kv {
  color: #6c71c4;
}
.highlight .kc {
  color: #cb4b16;
}
.highlight .kt {
  color: #cb4b16;
}
.highlight .kd {
  color: #cb4b16;
}
.highlight .s, .highlight .sb, .highlight .sc, .highlight .dl, .highlight .sd, .highlight .s2, .highlight .sh, .highlight .sx, .highlight .s1 {
  color: #859900;
}
.highlight .sa {
  color: #6c71c4;
}
.highlight .sr {
  color: #2aa198;
}
.highlight .si {
  color: #d33682;
}
.highlight .se {
  color: #d33682;
}
.highlight .nn {
  color: #b58900;
}
.highlight .nc {
  color: #b58900;
}
.highlight .no {
  color: #b58900;
}
.highlight .na {
  color: #268bd2;
}
.highlight .m, .highlight .mb, .highlight .mf, .highlight .mh, .highlight .mi, .highlight .il, .highlight .mo, .highlight .mx {
  color: #859900;
}
.highlight .ss {
  color: #859900;
}
    </style>
    <link href="stylesheets/screen-64c17253.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print-966d6edc.css" rel="stylesheet" media="print" />
      <script src="javascripts/all-42682627.js"></script>

    <script>
      $(function() { setupCodeCopy(); });
    </script>
  </head>

  <body class="index" data-languages="[&quot;shell&quot;,&quot;python&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar-cad8cdcb.png" alt="" />
      </span>
    </a>
    <div class="toc-wrapper">
      <img src="images/logo-28fd383d.png" class="logo" alt="" />
        <div class="lang-selector">
              <a href="#" data-language-name="shell">shell</a>
              <a href="#" data-language-name="python">python</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <ul id="toc" class="toc-list-h1">
          <li>
            <a href="#fa255f0ccc" class="toc-h1 toc-link" data-title="소개">소개</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#system-overview" class="toc-h2 toc-link" data-title="System Overview">System Overview</a>
                  </li>
                  <li>
                    <a href="#gpu" class="toc-h2 toc-link" data-title="GPU 보유 현황">GPU 보유 현황</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#6772c593e8" class="toc-h1 toc-link" data-title="사용 방법">사용 방법</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#4677f67d74" class="toc-h2 toc-link" data-title="사용 절차">사용 절차</a>
                  </li>
                  <li>
                    <a href="#gpu-2" class="toc-h2 toc-link" data-title="GPU 서버 접속">GPU 서버 접속</a>
                  </li>
                  <li>
                    <a href="#08e9b81abe" class="toc-h2 toc-link" data-title="코드 및 데이터 업로드">코드 및 데이터 업로드</a>
                  </li>
                  <li>
                    <a href="#c4d1c3a567" class="toc-h2 toc-link" data-title="자원 신청">자원 신청</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#97ce792b38" class="toc-h1 toc-link" data-title="심화 튜토리얼">심화 튜토리얼</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#tmux" class="toc-h2 toc-link" data-title="tmux를 이용한 세션유지">tmux를 이용한 세션유지</a>
                  </li>
                  <li>
                    <a href="#jupyter-notebook" class="toc-h2 toc-link" data-title="Jupyter notebook 실행">Jupyter notebook 실행</a>
                  </li>
                  <li>
                    <a href="#local-disk" class="toc-h2 toc-link" data-title="Local Disk 활용법">Local Disk 활용법</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#a6aa210ad3" class="toc-h1 toc-link" data-title="개발 환경 구축">개발 환경 구축</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#miniconda" class="toc-h2 toc-link" data-title="miniconda 환경 설정">miniconda 환경 설정</a>
                  </li>
                  <li>
                    <a href="#singulairty-container" class="toc-h2 toc-link" data-title="singulairty Container 활용">singulairty Container 활용</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#4adb650424" class="toc-h1 toc-link" data-title="사용정책">사용정책</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#d085b4587e" class="toc-h2 toc-link" data-title="파티션 정책">파티션 정책</a>
                  </li>
                  <li>
                    <a href="#07970efef4" class="toc-h2 toc-link" data-title="컴퓨팅 자원 정책">컴퓨팅 자원 정책</a>
                  </li>
                  <li>
                    <a href="#f127a65f44" class="toc-h2 toc-link" data-title="로컬 디스크 사용 정책">로컬 디스크 사용 정책</a>
                  </li>
              </ul>
          </li>
      </ul>
        <ul class="toc-footer">
            <li><a href='https://aix.inha.ac.kr/' target="_blank">인하대학교 인공지능융합연구센터</a></li>
            <li><a href='https://github.com/slatedocs/slate'>Documentation Powered by Slate</a></li>
            <li>Last updated on Jan 31</li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id='fa255f0ccc'>소개</h1>
<p>인하대학교 인공지능융합연구센터 (이하 ”AI 센터”)에 오신 것을 환영합니다. 저희 AI 센터는 최첨단 GPU 서버 센터를 구축하여 A100, A6000, A40 등의 고성능 컴퓨팅 자원을 인하대학교 학생 및 교수님들, 그리고 기업체 및 인천시민 여러분께 무상으로 제공하고 있습니다. 이를 통해 인공지능 연구와 개발에 필요한 모든 고성능 계산 작업을 지원하고자 합니다.
<br/>작성된 튜토리얼을 통해 원활한 사용과 연구에 도움이 되기를 진심으로 바라겠습니다.</p>

<aside class="notice">
AI 센터의 자원을 이용하시려면 먼저 <a href='https://aix.inha.ac.kr/?page_id=4109&vid=1' target="_blank">인하대학교 인공지능융합연구센터 홈페이지</a>를 통해 계정을 신청하시기 바랍니다.
</aside>

<p>공지 수신 및 기술적인 문제나 사용법에 대한 질문이 있으시면, <a href="https://discord.gg/PyBkTDz4Mp">디스코드 채널</a>에 입장하여 연락주시기 바랍니다.
<br/>추가로, 긴급 공지 사항을 위해 만들어진 <a href="https://open.kakao.com/o/gNVmxJof">카카오오픈채팅방</a>에 <strong style="color:red">반드시</strong> 참여를 부탁드립니다.</p>
<h3 id='system-overview'>System Overview</h3>
<p>Simple Linux Utility for Resource Management (이하 “Slurm”) 을 통해 GPU 자원을 제공하고 있습니다. Slurm은 클러스터 환경의 자원 관리 시스템으로, 사용자의 요청에 컴퓨팅 자원을 할당합니다.<br>
<br/> 사용자는 자원을 할당 받은 후, Conda와 Singularity 컨테이너 솔루션을 통해 사용자가 원하는 개발 환경에서 컴퓨팅 자원을 사용 할 수 있습니다.</p>

<p>자원이 모두 사용 중일 때는 대기를 해야하며, 자원이 확보될 시 Slurm이 대기하고 있던 사용자에게 할당해줍니다. <br/>
12시간 이상 GPU 사용이 없을 시 작업이 취소 될 수 있습니다.</p>
<h3 id='gpu'>GPU 보유 현황</h3>
<p>AI 센터에서는 11개의 GPU 서버 (56 GPUs) 를 제공하고 있습니다. </p>

<table><thead>
<tr>
<th>GPU 타입</th>
<th>GPU 메모리</th>
<th>GPU 서버 대수</th>
<th>서버 당 GPU 카드 개수</th>
</tr>
</thead><tbody>
<tr>
<td>A100</td>
<td>40 GB</td>
<td>4</td>
<td>4</td>
</tr>
<tr>
<td>A40</td>
<td>48 GB</td>
<td>3</td>
<td>8</td>
</tr>
<tr>
<td>A6000</td>
<td>48 GB</td>
<td>4</td>
<td>4</td>
</tr>
</tbody></table>
<h1 id='6772c593e8'>사용 방법</h1><h3 id='4677f67d74'>사용 절차</h3>
<p>GPU 서버 사용 과정은 아래와 같습니다:<br/>
SSH 로그인을 통한 서버 접속 (Login Node) -&gt; 코드 및 데이터 업로드 -&gt; GPU 자원 신청 -&gt; (환경 구축) -&gt; GPU 사용</p>

<ul>
<li>사용 가이드 영상</li>
</ul>

<iframe width="560" height="315" src="https://www.youtube.com/embed/GX4FgkJ2sRY?si=yDdse6TVn2HbKqlB" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen style="padding-left: 30px;"></iframe>
<h2 id='gpu-2'>GPU 서버 접속</h2>
<blockquote>
<p>본인의 ID로 입력하여 SSH 연결하시길 바랍니다. 만약 본인의 ID가 &quot;Gildong&quot;이면,</p>
</blockquote>
<div class="highlight"><pre class="highlight shell tab-shell"><code>ssh Gildong@165.246.75.159
</code></pre></div>
<p>사용자는 SSH 연결을 통해 Login Node 에 접속한 후, Slurm 시스템에게 GPU 자원 할당을 신청 할 수 있습니다.
<br/> SSH 연결은 Windows PowerShell, Ubuntu Terminal, MobaXterm 등의 프로그램을 통해 사용 할 수 있습니다.
<br>
<img src="images/serverSSH-599e19ff.png" width="550px" title="ssh 연결화면" alt="ssh 연결화면"></img></p>
<h2 id='08e9b81abe'>코드 및 데이터 업로드</h2>
<p>파일 업로드는 본인 계정의 이름으로 된 폴더에 할 수 있습니다.<br/>
파일 업로드는 GPU <b style="color:orange">자원을 할당 받지 않고도 가능</b>하며, GPU Node의 <u>로컬 디스크</u>를 사용할 경우 <b style="color:orange">CPU 자원만 할당</b>받아 사용하시면 됩니다.<br>
- 데이터 업로드는 <code>/shared/home/[본인 아이디]</code> 경로 아래에 하시면 됩니다.
- 데이터 및 코드는 AI 센터의 NAS에 업로드됩니다.</p>
<h2 id='c4d1c3a567'>자원 신청</h2>
<p>사용자는 원하는 시간, GPU 및 CPU 자원 등을 명시하여 요청할 수 있습니다. <strong style="color:coral">최대 7일</strong>의 사용 시간을 요청 할 수 있으며, 사용자들의 원활한 사용을 위해 AI센터에서는 사용 시간을 <b>모니터링</b>하고 있습니다. <br>
지속적으로 자원 요청 정책을 지키지 않는 사용자의 경우, <strong style="color:crimson">작업의 취소 및 패널티</strong>가 부과 될 수 있습니다. <br>
<br></p>

<blockquote>
<p>먼저 명령어로 자신의 파티션을 확인하기 (주의: `는 &#39; 와 다름)</p>
</blockquote>
<div class="highlight"><pre class="highlight shell tab-shell"><code>sacctmgr show assoc <span class="nv">format</span><span class="o">=</span>User,Partition where <span class="nv">user</span><span class="o">=</span><span class="sb">`</span><span class="nb">whoami</span><span class="sb">`</span>
</code></pre></div>
<aside class="notice">
GPU 신청 전에, 자신의 파티션을 먼저 확인하길 바랍니다.
</aside>

<blockquote>
<p>파티션 p1의 사용자가 A100 GPU 2개를 1일 동안 요청하기</p>
</blockquote>
<div class="highlight"><pre class="highlight shell tab-shell"><code>srun <span class="nt">--gres</span><span class="o">=</span>gpu:a100:2 <span class="nt">-p</span> p1 <span class="nt">--time</span><span class="o">=</span>1-00:00:00 <span class="nt">-J</span> cv_lab1 <span class="nt">--cpus-per-task</span><span class="o">=</span>20 <span class="nt">--pty</span> bash
</code></pre></div>
<blockquote>
<p>파티션 p2의 사용자가 A6000 GPU 2개를 12시간 동안 요청하기</p>
</blockquote>
<div class="highlight"><pre class="highlight shell tab-shell"><code>srun <span class="nt">--gres</span><span class="o">=</span>gpu:a6000:2 <span class="nt">-p</span> p2 <span class="nt">--time</span><span class="o">=</span>12:00:00 <span class="nt">-J</span> cv_lab1 <span class="nt">--pty</span> bash
</code></pre></div>
<blockquote>
<p>파티션 p3의 사용자가 A40 GPU 2개를 2일 동안 요청하기</p>
</blockquote>
<div class="highlight"><pre class="highlight shell tab-shell"><code>srun <span class="nt">--gres</span><span class="o">=</span>gpu:a40:2 <span class="nt">-p</span> p3 <span class="nt">--time</span><span class="o">=</span>2-00:00:00 <span class="nt">-J</span> cv_lab1 <span class="nt">--pty</span> bash
</code></pre></div>
<p>로그인을 한 후, 명령어로 GPU 할당 요청이 가능합니다.<br/>
<code>srun --gres=gpu:&lt;type&gt;:&lt;number&gt; -p &lt;partition&gt; --time=&lt;time&gt; -J &lt;jobname&gt; --cpus-per-core &lt;int&gt; --pty bash</code></p>

<table><thead>
<tr>
<th>옵션 이름</th>
<th>구분</th>
<th>설명</th>
<th>상세</th>
</tr>
</thead><tbody>
<tr>
<td><code>--gres=gpu:&lt;type&gt;:&lt;number&gt;</code></td>
<td>GPU 선택</td>
<td>GPU 타입 및 개수를 선택</td>
<td><code>&lt;type&gt;</code> : a100, a6000, a40 <br> <code>&lt;number&gt;</code> : 1 ~ 4 사이의 정수(a40은 3까지)</td>
</tr>
<tr>
<td><code>-p &lt;partition&gt;</code></td>
<td>파티션 선택</td>
<td>사용자마다 파티션 지정됨</td>
<td><code>&lt;partition&gt;</code> : p1, p2, p3 <br> 아래 명령어로 자신이 속한 파티션 확인 <br> <code>sacctmgr show assoc format=User,Partition where user=`whoami`</code></td>
</tr>
<tr>
<td><code>--time=&lt;time&gt;</code></td>
<td>사용 시간 설정</td>
<td>사용 시간을 <code>&lt;time&gt;</code>만큼 지정</td>
<td>7일 (7-00:00:00) 또는 168시간 (168:00:00) 이하의 시간</td>
</tr>
<tr>
<td><code>-J &lt;jobname&gt;</code></td>
<td>작업 이름 설정</td>
<td>작업의 이름을 <code>&lt;jobname&gt;</code>으로 설정</td>
<td></td>
</tr>
<tr>
<td><code>--mem &lt;memory size&gt;</code></td>
<td>메모리 설정</td>
<td>사용하고자 하는 memory 자원 크기를 설정</td>
<td><code>--mem 8G</code> 와 같이 설정할 수 있음.</td>
</tr>
</tbody></table>

<ul>
<li>자원 할당이 되었을경우</li>
</ul>

<p><img src="images/alloc_success-96e0bf26.png" width="550px" title="할당 성공" alt="Allocation success"><br>위와같이 host명이 login-n1에서 신청한 node의 이름으로 변경됨</img></p>

<ul>
<li>자원 할당 대기중일 경우</li>
</ul>

<p><img src="images/alloc_wait-a81dadb1.png" width="550px" title="할당 대기" alt="wait for Allocation"><br>사용자가 많을 경우, 위와 같이 할당대기중이라는 안내가 나옴.</img></p>

<aside class="warning"> GPU를 할당 받기 전, login-n1 에서 파이썬 코드를 실행시키지 마세요. 전체 인원에게 피해가 가며, 해당 유저는 페널티를 받을 수 있습니다. </aside>
<h3 id='095ccc3cbd'>대기열 상태 확인</h3>
<p><code>srun</code> 또는 <code>sbatch</code>로 신청한 자원이 이미 사용되고 있을경우, 대기열에 들어갑니다. 이때 대기열을 확인하고싶다면 우측 명령어를 사용하면 됩니다.</p>

<blockquote>
<p>신청한 작업의 ID를 squeue 명령어를 통해 확인하기(대기열 현황)</p>
</blockquote>
<div class="highlight"><pre class="highlight shell tab-shell"><code>squeue
</code></pre></div>
<blockquote>
<p>예상 시작시간 확인하기</p>
</blockquote>
<div class="highlight"><pre class="highlight shell tab-shell"><code>scontrol show job <span class="o">[</span>JOB ID] | <span class="nb">grep </span>StartTime
</code></pre></div>
<blockquote>
<p>실행중인 모든 작업의 시작시간(StartTime), 종료시간(EndTime) 확인</p>
</blockquote>
<div class="highlight"><pre class="highlight shell tab-shell"><code>scontrol show job | <span class="nb">grep</span> <span class="nt">-e</span> JobName <span class="nt">-e</span> StartTime
</code></pre></div>
<p><img src="./images/squeue.PNG" width="550px" title="squeue 화면" alt="checking queues"></img></p>
<h1 id='97ce792b38'>심화 튜토리얼</h1><h2 id='tmux'>tmux를 이용한 세션유지</h2>
<p><code>srun</code> 명령어를 사용하여 자원을 받고나서 세션을 종료하면, 자원도 자동으로 반환됩니다. 이를 방지하고싶다면, <code>tmux</code> 또는 <code>screen</code>명령어로 세션을 유지할 수 있습니다.</p>

<blockquote>
<p>tmux 실행</p>
</blockquote>
<div class="highlight"><pre class="highlight shell tab-shell"><code>tmux
</code></pre></div>
<p><img src="images/tmux-1ba88aa0.png" width="500px" title="tmux screen" alt="tmux 화면"></img></p>

<blockquote>
<p>tmux 세션 유지 상태로 나가기 (백그라운드에서 실행시키고 싶은경우)</p>
</blockquote>
<div class="highlight"><pre class="highlight shell tab-shell"><code>ctrl + b 를 누른후, d키를 누르기
</code></pre></div>
<blockquote>
<p>tmux 세션 리스트 확인</p>
</blockquote>
<div class="highlight"><pre class="highlight shell tab-shell"><code>tmux <span class="nb">ls</span>
</code></pre></div>
<blockquote>
<p>tmux 목록중 원하는 세션에 다시 접속하기</p>
</blockquote>
<div class="highlight"><pre class="highlight shell tab-shell"><code>tmux attach-session <span class="nt">-t</span> &lt;session number&gt;
</code></pre></div>
<blockquote>
<p>tmux session을 완전히 종료하기</p>
</blockquote>
<div class="highlight"><pre class="highlight shell tab-shell"><code>tmux kill-session <span class="nt">-t</span> &lt;session number&gt;
</code></pre></div>
<p><img src="images/tmux_ex-b6ecaa39.png" title="tmux cmd" alt="tmux 관련 명령어"></img></p>
<h2 id='jupyter-notebook'>Jupyter notebook 실행</h2>
<p>할당받은 GPU 노드에서 IP를 알아 낸 후, jupyter notebook을 웹에 띄웁니다.</p>

<blockquote>
<p>다음 명령어 수행후, inet 165.2*<em>.</em><strong>.</strong>* 부분의 ip주소를 복사</p>
</blockquote>
<div class="highlight"><pre class="highlight shell tab-shell"><code>ifconfig
</code></pre></div>
<p><img src="./images/ifconfig.PNG" width="550px" title="ip주소 확인" alt="check for ip addr"><br>사용자화면에서, 빨간색 표시 영역에 해당되는 주소(165로 시작)를 복사</img></p>

<blockquote>
<p>위에서 복사한 ip주소를 <165.2**.***.***> 부분에 넣고 port번호는 10100~10109 중 하나로 설정</p>
</blockquote>
<div class="highlight"><pre class="highlight shell tab-shell"><code>jupyter-notebook <span class="nt">--no-browser</span> <span class="nt">--ip</span><span class="o">=</span>165.2<span class="k">**</span>.<span class="k">***</span>.<span class="k">***</span> <span class="nt">--port</span><span class="o">=</span>10108
</code></pre></div>
<aside class="warning">만약 port 번호를 10100으로 설정했는데 실행이 안될경우, ⭐숫자를 1씩 증가시켜가며⭐ 실행되는 port 번호를 사용하면 됩니다. 만약 모든 포트번호를 사용했는데 실행이 안되는 경우, 아래의 연락처로 연락주시면 감사하겠습니다.<br>문의처: 인공지능융합연구센터 조병호 (bhjo12@inha.ac.kr, 032-860-9472) </aside>
<h2 id='local-disk'>Local Disk 활용법</h2>
<p>학습 데이터의 크기가 클 경우, 네트워크 병목 현상으로 인하여 학습이 지연될 수 있습니다. 이런 경우, 각각의 GPU Node의 Local Disk를 이용하여 학습한다면 더 빠른 속도로 학습할 수 있습니다.</p>

<ul>
<li>각 GPU 별 Node 명칭 <br>
A100 : a100-[n1~n4] <br>
A6000 : sv4ka-[n1~n4] <br>
A40 : sv8ka-[n1~n3] <br></li>
</ul>

<blockquote>
<p>Login node 접속 (port number : 22)</p>
</blockquote>
<div class="highlight"><pre class="highlight shell tab-shell"><code>ssh <span class="o">[</span>본인의 ID]@165.246.75.159
</code></pre></div>
<aside class="notice">
<code>--cpus-per-task</code> option을 사용해서 할당받을 Cpu core의 개수를 지정할 수 있습니다. <br>
각 GPU마다 <b>최대로 지정할 수 있는</b> CPU core수는 다릅니다. A100은 최대 20개, A6000은 최대 6개, A40은 최대 10개까지 할당받을 수 있습니다. <br>
만약 a40 GPU를 4개 할당받았다면, CPU는 최대 40개까지 할당받을 수 있습니다. <br>
Data를 불러온 후, GPU로 data를 전송할 때 전처리과정을 거치는데, 이때 CPU자원이 많을수록 처리속도가 빨라집니다.
</aside>

<aside class="warning">
할당시, GPU Node별 최대 할당가능한 core수 이상 지정하지 않도록 유의하세요.
</aside>
<h3 id='local'>local 디렉토리 생성 및 데이터 복사</h3>
<p>만약 이전에 저장한 GPU Node에서 작업하고 싶다면, <code>-w [GPU node 이름]</code> option을 이용해서 지정할 수 있습니다.</p>

<blockquote>
<p>할당받은 GPU Node 각각의 Local disk경로로 이동</p>
</blockquote>
<div class="highlight"><pre class="highlight shell tab-shell"><code><span class="nb">cd</span> /raid
</code></pre></div>
<blockquote>
<p>사용자 이름의 경로 생성</p>
</blockquote>
<div class="highlight"><pre class="highlight shell tab-shell"><code><span class="nb">mkdir</span> <span class="o">[</span>user name]
</code></pre></div>
<blockquote>
<p>자신의 home 경로에서 /raid/user_name 으로 데이터 복사</p>
</blockquote>
<div class="highlight"><pre class="highlight shell tab-shell"><code><span class="nb">cp</span> <span class="nt">-R</span> /shared/home/[user name]/data /raid/[user name]
</code></pre></div>
<blockquote>
<p>학습에 필요한 image file을 local disk로 복사</p>
</blockquote>
<div class="highlight"><pre class="highlight shell tab-shell"><code><span class="nb">cp</span> /shared/public/images/&lt;image name&gt; /raid/&lt;user name&gt;
</code></pre></div><h3 id='singularity-disk-mount'>Singularity 실행시 Disk mount</h3>
<ul>
<li>Singularity 실행시, <code>-B /raid</code> 옵션을 추가해 local disk를 mount 해줍니다.</li>
<li>만약 위의 옵션을 사용하지 않으면 singularity환경에서 <code>/raid</code> 경로를 볼 수 없습니다. <br>
<code>singularity exec -B /raid --nv /raid/[user name]/[image name] bash </code>
<br></li>
<li>local disk에 Mount가 잘 되었는지 확인하기 (singularity 접속상태에서)<br>
<code>ll /raid</code></li>
<li>Pytorch import 여부 확인 <br>
<code> python3 </code> 입력 후, <code>import torch</code> 입력시 이상이 없는지 확인.</li>
</ul>
<h3 id='27b537c1c7'>작업 완료 후 결과물 이동방법</h3>
<p>모든 GPU node의 Local Disk의 경로는 /raid 로 되어있습니다. 그리고 각 GPU node의 DISK용량은 약 3TB 이상(GPU node별 약간의 차이가 있음)입니다. <br>
계정 당 <b>최대 300GB</b>를 사용 할 수 있으며, 초과 사용 시, 다른 사용자를 위해서 디렉토리의 데이터는 <strong style="color:red;">삭제</strong>될 수 있습니다.
<aside class="warning">
중요한 모델 파일 및 코드는 항상 백업을 부탁드립니다.
</aside></p>
<h3 id='cpu-node'>CPU만 할당받아 특정 Node에 접근하기</h3>
<p>만약, a40 GPU <b>3번 node</b>에 GPU할당 없이 접속하여 데이터를 가져오고싶다면 다음 명령어 사용.<br>
<code>srun —-mem=8G -p p1 -w sv8ka-n3 —-pty bash </code></p>

<ul>
<li>p 다음에 자신이 속한 partition, -w 다음에 원하는 gpu 명칭 (a100→a100, a40→sv8ka, a6000→sv4ka) <br></li>
<li>이후 cp 명령어를 사용하여 복사 (<code>cp -R /원본경로 /대상경로</code>)<br>
예) <code>cp -R /shared/home/USER_NAME/data /raid/USER_NAME</code></li>
</ul>

<aside class="warning">
학습에 사용할 pytorch나 tensorflow image파일도 복사해야합니다.
</aside>

<p><br>
위의 문서 외의 추가적인 사용법은 아래 공식 API문서에서 확인하실 수 있습니다.
<br>
<a href='https://slurm.schedmd.com/documentation.html' target="_blank">Slurm Documentation</a> <br>
<a href='https://apptainer.org/user-docs/master/index.html' target="_blank">Singularity Documentation</a></p>

<aside class="success">
사용중 문의사항이 있을 경우, 디스코드 혹은 아래의 메일로 연락주시면 감사드리겠습니다. <br>
인하대학교 인공지능융합연구센터 조병호 (bhjo12@inha.ac.kr)
</aside>
<h1 id='a6aa210ad3'>개발 환경 구축</h1>
<p>현재 GPU 서버에서는 miniconda 환경과 singularity 환경을 지원하고 있습니다.
<br>별도의 docker환경은 제공하지 않지만, <a href="#singulairty-container">singularity image 변환</a>을 통해 docker image를 사용하실 수 있습니다.</p>
<h2 id='miniconda'>miniconda 환경 설정</h2>
<blockquote>
<p>설치 파일을 다운로드할 경로로 이동(to home directory)</p>
</blockquote>
<div class="highlight"><pre class="highlight shell tab-shell"><code><span class="nb">cd</span> ~
</code></pre></div>
<blockquote>
<p>Miniconda 설치 파일 다운로드</p>
</blockquote>
<div class="highlight"><pre class="highlight shell tab-shell"><code>wget https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh
</code></pre></div>
<blockquote>
<p>설치 파일 실행</p>
</blockquote>
<div class="highlight"><pre class="highlight shell tab-shell"><code>bash Miniconda3-latest-Linux-x86_64.sh
</code></pre></div>
<blockquote>
<p>Anaconda 설치 후 bash shell환경 재설정</p>
</blockquote>
<div class="highlight"><pre class="highlight shell tab-shell"><code><span class="nb">source</span> ~/.bashrc
</code></pre></div>
<blockquote>
<p>conda 환경 생성 예시</p>
</blockquote>
<div class="highlight"><pre class="highlight shell"><code>conda create <span class="nt">-n</span> &lt;환경 이름&gt; <span class="nv">python</span><span class="o">=</span>&lt;파이썬 버전&gt;
</code></pre></div>
<blockquote>
<p>conda 환경 실행</p>
</blockquote>
<div class="highlight"><pre class="highlight shell"><code>conda activate &lt;환경 이름&gt;
</code></pre></div>
<aside class="warning"> <i>conda: command not found</i> 오류 발생시 우측 예시와 같이 환경설정을 해야 함.</aside>

<p><img src="images/miniConda_setup-e3f586c0.png" width="550px" title="아나콘다 설치" alt="Conda setup"></img>
<br>
<img src="images/installation-c57b5667.png" width="550px" title="아나콘다 설치과정" alt="Conda setup2"><br>
설치를 위해 Enter(기본 세팅으로 설치)입력 </img>
<br>
<img src="images/install_2-e3f97af6.png" width="550px" title="아나콘다 설치과정 2" alt="Conda setup3"><br>
만약 설치 완료후 (base) 표시가 나오지않는다면 위의 그림처럼 실행</img></p>

<blockquote>
<p>다음 명령어 수행 (conda 환경설정 오류가 발생했을 경우에만)</p>
</blockquote>
<div class="highlight"><pre class="highlight shell tab-shell"><code>vi ~/.bashrc
</code></pre></div>
<blockquote>
<p>vi 편집기에서 입력모드(i)로 들어가서 파일끝에 다음 명령어 추가 후 저장(esc, :wq)하기.</p>
</blockquote>
<div class="highlight"><pre class="highlight shell"><code><span class="nb">export </span><span class="nv">PATH</span><span class="o">=</span>~/miniconda3/bin:<span class="nv">$PATH</span>
</code></pre></div>
<blockquote>
<p>환경변수 설정 반영</p>
</blockquote>
<div class="highlight"><pre class="highlight shell tab-shell"><code><span class="nb">source</span> ~/.bashrc
</code></pre></div><h2 id='singulairty-container'>singulairty Container 활용</h2>
<aside class="notice">
도커 이미지를 Singularity 이미지로 간편하게 변환하여 사용할 수 있습니다.
</aside>
<h3 id='sif-singularity-container'>sif이미지를 사용해서 singularity container 실행</h3>
<p>우측 코드를 참조하여 실행</p>

<blockquote>
<p>공용폴더(/shared/public/images)로 이동</p>
</blockquote>
<div class="highlight"><pre class="highlight shell tab-shell"><code><span class="nb">cd</span> /shared/public/images

<span class="c">#공용폴더에서 사용할 Singularity 이미지(.sif)를 확인</span>
<span class="nb">ls</span>
</code></pre></div>
<blockquote>
<p>원하는 이미지가 있고, 이를 사용하려면 다음 명령어 실행</p>
</blockquote>
<div class="highlight"><pre class="highlight shell tab-shell"><code>singularity <span class="nb">exec</span> <span class="nt">--nv</span> /shared/public/images/&lt;imagefile name&gt; bash
</code></pre></div>
<blockquote>
<p>만약 이미지를 jupyter notebook으로 실행시키고 싶다면</p>
</blockquote>
<div class="highlight"><pre class="highlight shell tab-shell"><code>singularity <span class="nb">exec</span> <span class="nt">--nv</span> /shared/public/images/&lt;imagefile name&gt; jupyter notebook <span class="nt">--no-browser</span> <span class="nt">--ip</span><span class="o">=</span>&lt;위에서 복사한 ip주소&gt; <span class="nt">--port</span><span class="o">=</span>&lt;위에서 설정한 포트번호&gt;

<span class="c">#singularity Container의 사용을 중단하고 싶다면</span>
<span class="nb">exit</span>
</code></pre></div>
<aside class="warning">
<code>/shared/public/images</code> 경로에 Singularirty 이미지를 저장하지 마세요.
본인계정의 home 경로에 저장하시길 부탁드립니다.
</aside>
<h3 id='docker-singularity-sif-docker-hub'>Docker 이미지를 Singularity SIF로 변환하기 - Docker Hub 사용편</h3>
<ol>
<li><p>Docker 이미지 선택 : Docker hub에서 변환하고자 하는 Dokcer image의 url을 찾습니다.
<br> 이때, 본인이 원하는 이미지가 docker hub에 없다면 업로드 할 수 있습니다(회원가입 필요).
<br>
<br> - docker hub 접속 (<a href="https://hub.docker.com/">https://hub.docker.com/</a>)
<br><img src="images/docker_p1-59e4da44.png" width="550px" height="300px" title="docker 홈페이지" alt="Docker homepage"></img>
<br>
<br> - 원하는 docker Image 검색  ( ※본인의 이미지를 docker hub에 올릴 수 있습니다※)
<br><img src="images/docker_p2-984e084e.png" width="550px" height="300px" title="docker image list" alt="Docker image list"></img>
<br>
<br> - 원하는 도커 이미지 선택
<br><img src="images/docker_p3-4172b1c9.png" width="550px" height="300px" title="docker hash name" alt="Docker hash name"></img></p></li>
<li><p>Terminal로 복귀 및 변환 명령어 실행
<br>예) <code>singularity build ~/my_cuda_image.sif docker://pytorch/pytorch:1.9.1-cuda11.1-cudnn8-devel</code></p></li>
</ol>

<ul>
<li>singularity build시, 시간이 오래걸릴 수 있습니다. 또한 singularity image파일을 저장할 경우 꼭 본인 계정의 home directory에 저장할 것을 부탁드립니다. (~/파일이름.sif) 
<br><strong>/shared/public/images에 하지 않기</strong></li>
</ul>
<h3 id='docker-singularity-sif'>Docker 이미지를 Singularity SIF로 변환하기 - 로컬 이미지 사용편</h3>
<ul>
<li>Docker 이미지 저장</li>
<li>Singularity 명령어 실행</li>
</ul>
<h1 id='4adb650424'>사용정책</h1><h2 id='d085b4587e'>파티션 정책</h2>
<table><thead>
<tr>
<th>구분</th>
<th style="text-align: center">Class A, 참여교수</th>
<th style="text-align: center">Class B, 교내교수</th>
<th style="text-align: center">Class C, 외부 사용자</th>
<th style="text-align: center">비고</th>
</tr>
</thead><tbody>
<tr>
<td>A100-1</td>
<td style="text-align: center">O</td>
<td style="text-align: center"></td>
<td style="text-align: center"></td>
<td style="text-align: center"></td>
</tr>
<tr>
<td>A100-2</td>
<td style="text-align: center">O</td>
<td style="text-align: center"></td>
<td style="text-align: center"></td>
<td style="text-align: center"></td>
</tr>
<tr>
<td>A100-3</td>
<td style="text-align: center">O</td>
<td style="text-align: center">O</td>
<td style="text-align: center">O</td>
<td style="text-align: center"></td>
</tr>
<tr>
<td>A100-4</td>
<td style="text-align: center">O</td>
<td style="text-align: center">O</td>
<td style="text-align: center">O</td>
<td style="text-align: center"></td>
</tr>
<tr>
<td>A6000-1</td>
<td style="text-align: center">O</td>
<td style="text-align: center"></td>
<td style="text-align: center"></td>
<td style="text-align: center"></td>
</tr>
<tr>
<td>A6000-2</td>
<td style="text-align: center">O</td>
<td style="text-align: center">O</td>
<td style="text-align: center"></td>
<td style="text-align: center"></td>
</tr>
<tr>
<td>A6000-3</td>
<td style="text-align: center">O</td>
<td style="text-align: center">O</td>
<td style="text-align: center">O</td>
<td style="text-align: center"></td>
</tr>
<tr>
<td>A6000-4</td>
<td style="text-align: center">O</td>
<td style="text-align: center">O</td>
<td style="text-align: center">O</td>
<td style="text-align: center"></td>
</tr>
<tr>
<td>A40-1</td>
<td style="text-align: center">O</td>
<td style="text-align: center"></td>
<td style="text-align: center"></td>
<td style="text-align: center">LocalDisk 권장</td>
</tr>
<tr>
<td>A40-2</td>
<td style="text-align: center">O</td>
<td style="text-align: center">O</td>
<td style="text-align: center">O</td>
<td style="text-align: center">LocalDisk 권장</td>
</tr>
<tr>
<td>A40-3</td>
<td style="text-align: center">O</td>
<td style="text-align: center">O</td>
<td style="text-align: center">O</td>
<td style="text-align: center">LocalDisk 권장</td>
</tr>
</tbody></table>
<h2 id='07970efef4'>컴퓨팅 자원 정책</h2>
<ul>
<li>기본 정책</li>
</ul>

<table><thead>
<tr>
<th>구분</th>
<th>정책</th>
<th>비고</th>
</tr>
</thead><tbody>
<tr>
<td>작업 당 최대 작업 시간</td>
<td><span style='background-color:#fff5b1; color:red'>7일</span> (7-00:00:00)</td>
<td>- 모든 작업에는 시간 지정 필수 <br> - 추가 작업 시간 필요 시 별도 요청</td>
</tr>
<tr>
<td>계정 당 저장 공간 용량 제한</td>
<td><span style='background-color:#fff5b1; color:red'>100G</span></td>
<td>- 추가 공간 필요 시 사유와 함께 요청</td>
</tr>
<tr>
<td>계정 당 최대 작업 개수</td>
<td>100개</td>
<td>-</td>
</tr>
<tr>
<td>사용 가능 최대 GPU 개수</td>
<td>a100: 4개/ a6000:4개/ a40:4개</td>
<td>a40:4개 초과 신청 할 경우, 취소 될 수 있음</td>
</tr>
<tr>
<td>사용 가능 최대 CPU Core 개수</td>
<td>a100: 20개/ a6000:6개/ a40:10개</td>
<td>* 할당받은 GPU수 * 까지 사용 가능 (a40 4개 사용 경우, 40개)</td>
</tr>
</tbody></table>

<ul>
<li>NAS 정책</li>
</ul>

<table><thead>
<tr>
<th>구분</th>
<th>경로</th>
<th>접근 권한</th>
<th>비고</th>
</tr>
</thead><tbody>
<tr>
<td>공용 저장 공간</td>
<td>/shared/public</td>
<td>모든 계정 가능</td>
<td>-</td>
</tr>
<tr>
<td>계정 별 저장 공간</td>
<td>/shared/home/계정명</td>
<td>본인 계정만 가능</td>
<td>계정 당 100GB</td>
</tr>
</tbody></table>
<h2 id='f127a65f44'>로컬 디스크 사용 정책</h2>
<table><thead>
<tr>
<th>구분</th>
<th>경로</th>
<th>노드</th>
<th>비고</th>
</tr>
</thead><tbody>
<tr>
<td>계정 별 저장 공간</td>
<td><code>/raid/계정명</code></td>
<td>sv8ka[n1-n3], sv4ka[n1-n4],a100[n1-n4]</td>
<td>계정 당 최대 300GB</td>
</tr>
</tbody></table>

<aside class="warning">
사용자가 많아져 해당 경로가 가득차면(Disk Full) 다른 사용자를 위해서 디렉토리의 데이터는 <b style='color:crimson'>삭제</b>될 수 있습니다. 수시로 로컬 디스크의 데이터를 백업하고 정리하시는 것을 추천 드립니다.
<br>
인공지능융합센터에서는 수시로 용량을 검사하며, <u>한달 이상 방치된 파일</u>은 <strong style='color:crimson'>삭제</strong> 될 수 있음을 알려드립니다.
</aside>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="shell">shell</a>
                <a href="#" data-language-name="python">python</a>
          </div>
      </div>
    </div>
  </body>
</html>
